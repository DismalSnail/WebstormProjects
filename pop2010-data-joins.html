<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        body {
            font-family: Helvetica,serif;
        }

        svg {
            width: 500px;
            height: 500px;
        }

        .top-label {
            font-size: 13px;
            font-style: italic;
            text-transform: uppercase;
            float: left;
        }

        .age-label {
            text-align: right;
            font-weight: bold;
            width: 90px;
            padding-right: 10px;
        }

        .clearfix {
            clear: both;
        }

        .bar {
            fill: darkslateblue;
        }

        .bar-label {
            text-anchor: end;
        }

        .axis-label {
            text-anchor: middle;
            font-size: 13px;
        }
    </style>
</head>
<body>
<script src="http://d3js.org/d3.v3.min.js"></script>

<script>
    var popData=[
        {value:1.6,age:"80 and up",position:0},
        {value:1.5,age:"75-79",position:1},
        {value:2.1,age:"70-74",position:2},
        {value:2.6,age:"65-69",position:3},
        {value:3.4,age:"60-64",position:4},
        {value:4.5,age:"55-59",position:5},
        {value:5.1,age:"50-54",position:6},
        {value:6.0,age:"45-40",position:7},
        {value:6.6,age:"40-44",position:8},
        {value:7.1,age:"35-39",position:9},
        {value:7.3,age:"30-34",position:10},
        {value:8.1,age:"25-29",position:11},
        {value:8.9,age:"20-24",position:12},
        {value:8.8,age:"15-19",position:13},
        {value:8.6,age:"10-14",position:14},
        {value:8.8,age:"5-9",position:15},
        {value:9.3,age:"0-4",position:16}];

    var axisData=[0, 2.5, 5.0, 7.5];
    var width=400,
        leftMargin=100,
        topMargin=30,
        barHeight=20,
        barGap=5,
        tickGap=5,
        tickHeight=10,
        scaleFactor=width/popData[16].value,
        barSpaceing = barHeight +barGap,
        translateText="translate("+ leftMargin+","+topMargin+")",
        scaleText="scale("+scaleFactor+",1)";

    const body = d3.select("body");
    body.append("h2")
        .text("Age distribution of the world, 2010");

    body.append("div")
        .attr("class","top-label age-label")
        .append("p")
        .text("age group");

    body.append("div")
        .attr("class","top-label")
        .append("p")
        .text("portion of the population");

    body.append("div")
        .attr("class","clearfix");

    var svg = body.append("svg");

    var barGroup=svg.append("g")
        .attr("transform",translateText+" "+scaleText)
        .attr("class","bar");

    barGroup.selectAll("rect")
        .data(popData)
        .enter().append("rect")
                    .attr("x",0)
                    .attr("height",barHeight)
                    .attr("width",function (d) {
                        return d.value;
                    })
                    .attr("y",function (d) {
                        return d.position*barSpaceing;
                    });

    var barLabelGroup = svg.append("g")
                            .attr("transform",translateText)
                            .attr("class","bar-label");

    barLabelGroup.selectAll("text")
        .data(popData)
        .enter().append("text")
        .attr("x",-10)
        .attr("y",function (d,i) {
            return d.position*barSpaceing+barHeight*(2/3);
        })
        .text(function (d) {
            return d.age;
        });

    var axisTickGroup = svg.append("g")
        .attr("transform",translateText)
        .attr("stroke","black");

    axisTickGroup.selectAll("line")
        .data(axisData)
        .enter().append("line")
        .attr("x1",function (d) {
            return d*scaleFactor;
        })
        .attr("x2",function (d) {
            return d*scaleFactor;
        })
        .attr("y1",0)
        .attr("y2",-tickHeight);

    var axisLabelGroup=svg.append("g")
        .attr("transform",translateText)
        .attr("class","axis-label");

    axisLabelGroup.selectAll("text")
        .data(axisData)
        .enter().append("text")
        .attr("x",function (d) {
            return d*scaleFactor;
        })
        .attr("y",-tickHeight-tickGap)
        .text(function (d) {
            return d+"%";
        })

</script>
</body>
</html>